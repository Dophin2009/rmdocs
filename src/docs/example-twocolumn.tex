\documentclass[11pt]{article}                             % Declare document class

\usepackage{multicol}                                     % Declare packages used
\usepackage[margin=2.5cm]{geometry}                       % Set geometry options
\usepackage{graphicx,caption}
\usepackage{nonfloat}
\usepackage{fancyhdr}
\usepackage{blindtext}

\newenvironment{colfigure}{                               % Defining a new environment
  {\noindent\minipage{\linewidth}}                        % Commands/text to put before
  {\endminipage\par\bigskip}                              % Commands/text to put after
}

\newcommand{\colgraphic}[2]{%%                            % Defining a custom command
  \begin{colfigure}                                       % Use the environment defined earlier
    \centering                                            % Center contents
    \includegraphics[width=0.85\linewidth]{#1}            % Include the specified image
    \captionof{figure}{#2}                                % Print a caption
  \end{colfigure}
}

\pagestyle{fancy}                                         % Use fancy header style
\fancyhf{}
\rhead{Writing Documents with LaTeX, R, and Rmarkdown}    % Right text in header
\lhead{\thepage\enspace Example Documents}                % Left text in header

\begin{document}                                          % Begin document

\section{Introduction}                                    % Define section header
\blindtext[1]                                             % Generate lorem ipsum

\medskip                                                  % Blank space
\noindent\makebox[\linewidth]{                            % Add a horizontal line
  \rule{\textwidth}{0.2pt}
}

\begin{multicols}{2}                                      % Begin a two-column layout
                                                          % Using an environment called multicols
  \section{Background}                                    % Define a subsection
  \blindtext

  \section{Analysis}
  \blindtext

  \colgraphic{./xkcd-file-ext.png}{Here's a caption!}     % Use our command from earlier to add
  \bigskip                                                % an image

  \noindent\blindtext                                     % More lorem ipsum

\end{multicols}                                           % End multicols environment

\end{document}                                            % End document
